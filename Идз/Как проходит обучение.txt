Процесс обучения модели проходит в несколько шагов:

Инициализация модели:

Загружается предобученная модель (например, MobileNetV2) и добавляются дополнительные слои для решения вашей задачи (в данном случае классификация).
Подготовка данных:

Данные разделяются на обучающие и проверочные (валидационные).
Применяется аугментация для увеличения разнообразия данных (например, повороты, масштабирование).
Процесс обучения:

Данные передаются в модель по батчам.
Модель предсказывает метки классов, и на основе разницы между предсказанными и истинными значениями рассчитывается функция потерь.
На основе градиентов функция потерь минимизируется, обновляя веса модели с помощью оптимизатора (например, Adam).
Валидация:

После каждого эпохи (прохождения через все данные) проверяется точность модели на валидационном наборе.
Используются метрики, такие как accuracy и val_accuracy, для оценки производительности.
Сохранение модели:

Модель сохраняется, если она улучшает результат на валидационном наборе (контролируется через ModelCheckpoint).